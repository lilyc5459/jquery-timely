!function(r,e){var t=function(t,i){this.wrapper=t,this.$wrapper=r(t),this.options=i,this.$win=r(e)};t.prototype={defaults:{container:".timely",groups:".timely__groups",marker_major:".timely__markers--major",marker_minor:".timely__markers--minor",marker_event:".timely__event",order:!0,interval:1},init:function(){var e=this;return e.config=r.extend({},e.defaults,e.options),e.build(),e.bindEvents(),e},build:function(){var e=this,t=e.config.interval,i=e.$wrapper.width();e.$wrapper.prepend('<div class="timely"></div>'),r(e.config.container).css("width",i).prepend('<ul class="timely__groups"></ul>');var n=[];r("[data-year]").each(function(){var e={year:r(this).data("year"),month:r(this).data("month"),day:r(this).data("day")};n.push(e)}),n.sort(e.sortEvents(e.config.order));var a,o;e.config.order?(a=n[0].year,o=n[n.length-1].year):(a=n[n.length-1].year,o=n[0].year);var s=Math.abs(a-o);t=10>=s?1:50>=s?5:100>=s?10:500>=s?50:100;for(var d=Math.ceil(s/t)+1,l=i/d,c=e.config.order?a:o,p=0;d>p;p++)p>0&&(c=e.config.order?c+t:c-t),r("<li>",{"data-marker-year":c,style:"width:"+l+"px"}).append(r("<ul>",{"class":"timely__markers--minor"})).append(r("<div>",{"class":"timely__markers--major"})).append(r("<span>",{text:c})).appendTo(e.config.groups);var f=e.config.order?c+t:c-t;r("<span>",{text:f}).appendTo(e.config.groups+"> li:last-child");var h=0,m="m";5>=t?(h=12,m="m"):(h=10,m="y");for(var y=0;h>y;y++)"d"===m||("m"===m?r("<li>",{"data-marker-month":y,style:"width:"+l/(h+1)}).appendTo(e.config.marker_minor):"y"===m&&r("<li>",{style:"width:"+l/(h+1)+"px"}).appendTo(e.config.marker_minor));r.each(n,function(i,n){if("d"===m);else if("m"===m);else if("y"===m){var o=Math.floor((n.year-a)/t)+1,s=Math.ceil((n.year-a)%h)+1;r().find(""),r("<div>",{"class":"timely__event","data-year":n.year}).appendTo(e.config.groups+" > li:nth-child("+o+") "+e.config.marker_minor+" > li:nth-child("+s+")"),console.log(e.config.groups+" > li:nth-child("+o+") "+e.config.marker_minor+" > li:nth-child("+s+")")}})},sortEvents:function(r){return function(e,t){var i,n;r?(i=-1,n=1):(i=1,n=-1);var a=e.year,o=t.year;if(a===o){var s=e.month,d=t.month;if(s===d){var l=e.day,c=t.day;return l===c?0:c>l?i:l>c?n:0}return d>s?i:s>d?n:0}return o>a?i:a>o?n:0}},bindEvents:function(){},destroy:function(){}},t.defaults=t.prototype.defaults,r.fn.timely=function(r){return this.destroy=function(){this.each(function(){new t(this,r).destroy()})},this.each(function(){new t(this,r).init()})}}(jQuery,window,document);